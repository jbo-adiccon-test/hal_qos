\doxysection{classification.\+c File Reference}
\label{classification_8c}\index{classification.c@{classification.c}}
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$limits.\+h$>$}\newline
{\ttfamily \#include $<$sys/stat.\+h$>$}\newline
{\ttfamily \#include $<$errno.\+h$>$}\newline
{\ttfamily \#include \char`\"{}classification.\+h\char`\"{}}\newline
\doxysubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \textbf{ qos\+\_\+struct}
\end{DoxyCompactItemize}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \textbf{ CLASS\+\_\+\+MASK\+\_\+\+IPV4}~32
\item 
\#define \textbf{ CLASS\+\_\+\+MASK\+\_\+\+IPV6}~128
\item 
\#define \textbf{ CLASS\+\_\+\+FW\+\_\+\+FILENAME}~\char`\"{}/tmp/qos\+\_\+rules.\+sh\char`\"{}
\item 
\#define \textbf{ CLASS\+\_\+\+FW\+\_\+\+DEBUG}~\char`\"{}/home/tester/qos\+\_\+rules.\+sh\char`\"{}
\item 
\#define \textbf{ CLASS\+\_\+\+FW\+\_\+\+RELOAD\+\_\+\+FILENAME}~\char`\"{}/etc/utopia/service.\+d/firewall\+\_\+log\+\_\+handle.\+sh\char`\"{}
\item 
\#define \textbf{ CLASS\+\_\+\+FW\+\_\+\+RELOAD\+\_\+\+DEBUG}~\char`\"{}/home/tester/firewall\+\_\+log\+\_\+handle.\+sh\char`\"{}
\item 
\#define \textbf{ CLASS\+\_\+\+IPTABLES\+\_\+\+MANGLE\+\_\+\+CMD}~\char`\"{}iptables -\/t mangle\char`\"{}
\end{DoxyCompactItemize}
\doxysubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \textbf{ class\+\_\+table} \{ \textbf{ IPTABLES\+\_\+\+IPV4} = (1 $<$$<$ 0)
, \textbf{ IPTABLES\+\_\+\+IPV6} = (1 $<$$<$ 1)
 \}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\textbf{ qos\+\_\+struct} \textbf{ init\+Qos\+Class} (const struct \textbf{ qos\+\_\+class} $\ast$class)
\item 
int \textbf{ dealloc\+\_\+testclass} (\textbf{ qos\+\_\+struct} $\ast$class)
\item 
int \textbf{ main} ()
\item 
int \textbf{ qos\+\_\+add\+Class} (const struct \textbf{ qos\+\_\+class} $\ast$param)
\item 
int \textbf{ qos\+\_\+remove\+All\+Classes} ()
\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\mbox{\label{classification_8c_a0036c19278e6b8c0eea72c195f9efcd0}} 
\index{classification.c@{classification.c}!CLASS\_FW\_DEBUG@{CLASS\_FW\_DEBUG}}
\index{CLASS\_FW\_DEBUG@{CLASS\_FW\_DEBUG}!classification.c@{classification.c}}
\doxysubsubsection{CLASS\_FW\_DEBUG}
{\footnotesize\ttfamily \#define CLASS\+\_\+\+FW\+\_\+\+DEBUG~\char`\"{}/home/tester/qos\+\_\+rules.\+sh\char`\"{}}



Definition at line \textbf{ 18} of file \textbf{ classification.\+c}.

\mbox{\label{classification_8c_a7562d6fb7949c4e14a05fcbcc38fbf64}} 
\index{classification.c@{classification.c}!CLASS\_FW\_FILENAME@{CLASS\_FW\_FILENAME}}
\index{CLASS\_FW\_FILENAME@{CLASS\_FW\_FILENAME}!classification.c@{classification.c}}
\doxysubsubsection{CLASS\_FW\_FILENAME}
{\footnotesize\ttfamily \#define CLASS\+\_\+\+FW\+\_\+\+FILENAME~\char`\"{}/tmp/qos\+\_\+rules.\+sh\char`\"{}}



Definition at line \textbf{ 17} of file \textbf{ classification.\+c}.

\mbox{\label{classification_8c_a95e8153ae3cb6a746a8a9f7a5700270e}} 
\index{classification.c@{classification.c}!CLASS\_FW\_RELOAD\_DEBUG@{CLASS\_FW\_RELOAD\_DEBUG}}
\index{CLASS\_FW\_RELOAD\_DEBUG@{CLASS\_FW\_RELOAD\_DEBUG}!classification.c@{classification.c}}
\doxysubsubsection{CLASS\_FW\_RELOAD\_DEBUG}
{\footnotesize\ttfamily \#define CLASS\+\_\+\+FW\+\_\+\+RELOAD\+\_\+\+DEBUG~\char`\"{}/home/tester/firewall\+\_\+log\+\_\+handle.\+sh\char`\"{}}



Definition at line \textbf{ 20} of file \textbf{ classification.\+c}.

\mbox{\label{classification_8c_a1cb9a98219b89cd96775287b7109ae2f}} 
\index{classification.c@{classification.c}!CLASS\_FW\_RELOAD\_FILENAME@{CLASS\_FW\_RELOAD\_FILENAME}}
\index{CLASS\_FW\_RELOAD\_FILENAME@{CLASS\_FW\_RELOAD\_FILENAME}!classification.c@{classification.c}}
\doxysubsubsection{CLASS\_FW\_RELOAD\_FILENAME}
{\footnotesize\ttfamily \#define CLASS\+\_\+\+FW\+\_\+\+RELOAD\+\_\+\+FILENAME~\char`\"{}/etc/utopia/service.\+d/firewall\+\_\+log\+\_\+handle.\+sh\char`\"{}}



Definition at line \textbf{ 19} of file \textbf{ classification.\+c}.

\mbox{\label{classification_8c_a157effcdb39a9359a985714593fa0870}} 
\index{classification.c@{classification.c}!CLASS\_IPTABLES\_MANGLE\_CMD@{CLASS\_IPTABLES\_MANGLE\_CMD}}
\index{CLASS\_IPTABLES\_MANGLE\_CMD@{CLASS\_IPTABLES\_MANGLE\_CMD}!classification.c@{classification.c}}
\doxysubsubsection{CLASS\_IPTABLES\_MANGLE\_CMD}
{\footnotesize\ttfamily \#define CLASS\+\_\+\+IPTABLES\+\_\+\+MANGLE\+\_\+\+CMD~\char`\"{}iptables -\/t mangle\char`\"{}}



Definition at line \textbf{ 21} of file \textbf{ classification.\+c}.

\mbox{\label{classification_8c_aac44c69433c499f8f6b289be48d15586}} 
\index{classification.c@{classification.c}!CLASS\_MASK\_IPV4@{CLASS\_MASK\_IPV4}}
\index{CLASS\_MASK\_IPV4@{CLASS\_MASK\_IPV4}!classification.c@{classification.c}}
\doxysubsubsection{CLASS\_MASK\_IPV4}
{\footnotesize\ttfamily \#define CLASS\+\_\+\+MASK\+\_\+\+IPV4~32}



Definition at line \textbf{ 14} of file \textbf{ classification.\+c}.

\mbox{\label{classification_8c_ab68ef077d811c3905bca07df9889a818}} 
\index{classification.c@{classification.c}!CLASS\_MASK\_IPV6@{CLASS\_MASK\_IPV6}}
\index{CLASS\_MASK\_IPV6@{CLASS\_MASK\_IPV6}!classification.c@{classification.c}}
\doxysubsubsection{CLASS\_MASK\_IPV6}
{\footnotesize\ttfamily \#define CLASS\+\_\+\+MASK\+\_\+\+IPV6~128}



Definition at line \textbf{ 15} of file \textbf{ classification.\+c}.



\doxysubsection{Enumeration Type Documentation}
\mbox{\label{classification_8c_a9e6af64356c2d601cdb49b676d4fe1db}} 
\index{classification.c@{classification.c}!class\_table@{class\_table}}
\index{class\_table@{class\_table}!classification.c@{classification.c}}
\doxysubsubsection{class\_table}
{\footnotesize\ttfamily enum \textbf{ class\+\_\+table}}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{IPTABLES\_IPV4@{IPTABLES\_IPV4}!classification.c@{classification.c}}\index{classification.c@{classification.c}!IPTABLES\_IPV4@{IPTABLES\_IPV4}}}\mbox{\label{classification_8c_a9e6af64356c2d601cdb49b676d4fe1dba781b1fdbefbe39fc6edf90430244c503}} 
IPTABLES\+\_\+\+IPV4&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{IPTABLES\_IPV6@{IPTABLES\_IPV6}!classification.c@{classification.c}}\index{classification.c@{classification.c}!IPTABLES\_IPV6@{IPTABLES\_IPV6}}}\mbox{\label{classification_8c_a9e6af64356c2d601cdb49b676d4fe1dbab4889de7d1672b8b83e5460efbca2db0}} 
IPTABLES\+\_\+\+IPV6&\\
\hline

\end{DoxyEnumFields}


Definition at line \textbf{ 23} of file \textbf{ classification.\+c}.



\doxysubsection{Function Documentation}
\mbox{\label{classification_8c_a0db1aa13c019518d9b6ca22ddb19b9f9}} 
\index{classification.c@{classification.c}!dealloc\_testclass@{dealloc\_testclass}}
\index{dealloc\_testclass@{dealloc\_testclass}!classification.c@{classification.c}}
\doxysubsubsection{dealloc\_testclass()}
{\footnotesize\ttfamily int dealloc\+\_\+testclass (\begin{DoxyParamCaption}\item[{\textbf{ qos\+\_\+struct} $\ast$}]{class }\end{DoxyParamCaption})}

Sets the space free of \doxyref{qos\+\_\+struct}{p.}{structqos__struct} 
\begin{DoxyParams}{Parameters}
{\em class} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 SUCCESS -\/1 FAIL 
\end{DoxyReturn}


Definition at line \textbf{ 187} of file \textbf{ classification.\+c}.

\mbox{\label{classification_8c_a152a8b24830cb6d60e74a264ce9787d6}} 
\index{classification.c@{classification.c}!initQosClass@{initQosClass}}
\index{initQosClass@{initQosClass}!classification.c@{classification.c}}
\doxysubsubsection{initQosClass()}
{\footnotesize\ttfamily \textbf{ qos\+\_\+struct} init\+Qos\+Class (\begin{DoxyParamCaption}\item[{const struct \textbf{ qos\+\_\+class} $\ast$}]{class }\end{DoxyParamCaption})}

Allocates the data of \doxyref{qos\+\_\+class}{p.}{structqos__class} 
\begin{DoxyParams}{Parameters}
{\em class} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\doxyref{qos\+\_\+struct}{p.}{structqos__struct} of class 
\end{DoxyReturn}


Definition at line \textbf{ 171} of file \textbf{ classification.\+c}.

\mbox{\label{classification_8c_ae66f6b31b5ad750f1fe042a706a4e3d4}} 
\index{classification.c@{classification.c}!main@{main}}
\index{main@{main}!classification.c@{classification.c}}
\doxysubsubsection{main()}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Test main func with a debug struct in main to add an set to add (pseudo) classification \begin{DoxyReturn}{Returns}
0 SUCCESS -\/1 FAIL 
\end{DoxyReturn}


Definition at line \textbf{ 200} of file \textbf{ classification.\+c}.

\mbox{\label{classification_8c_a2f2af0ce3ad3f1c2878c30c12df8795c}} 
\index{classification.c@{classification.c}!qos\_addClass@{qos\_addClass}}
\index{qos\_addClass@{qos\_addClass}!classification.c@{classification.c}}
\doxysubsubsection{qos\_addClass()}
{\footnotesize\ttfamily int qos\+\_\+add\+Class (\begin{DoxyParamCaption}\item[{const struct \textbf{ qos\+\_\+class} $\ast$}]{param }\end{DoxyParamCaption})}

API function checks the data in classification struct from .h file. Then build the dscp\+\_\+mark iptables in that kind\+:

dmcli e\+RT addtable Device.\+Qo\+S.\+Classification. dmcli e\+RT setv Device.\+Qo\+S.\+Classification.\+1.\+Source\+Port int -\/1 dmcli e\+RT setv Device.\+Qo\+S.\+Classification.\+1.\+Source\+Port\+Range\+Max int -\/1 dmcli e\+RT setv Device.\+Qo\+S.\+Classification.\+1.\+Dest\+Port int -\/1 dmcli e\+RT setv Device.\+Qo\+S.\+Classification.\+1.\+Dest\+Port\+Range\+Max int -\/1 dmcli e\+RT setv Device.\+Qo\+S.\+Classification.\+1.\+Protocol int -\/1

dmcli e\+RT setv Device.\+Qo\+S.\+Classification.\+1.\+Traffic\+Class int 2 dmcli e\+RT setv Device.\+Qo\+S.\+Classification.\+1.\+Chain\+Name string \char`\"{}postrouting\+\_\+qos\char`\"{}

dmcli e\+RT setv Device.\+Qo\+S.\+Classification.\+1.\+Iface\+Out string \char`\"{}erouter0\char`\"{} dmcli e\+RT setv Device.\+Qo\+S.\+Classification.\+1.\+DSCPMark int 32 dmcli e\+RT setv Device.\+Qo\+S.\+Classification.\+1.\+Source\+MACAddress string \char`\"{}00\+:e0\+:4c\+:81\+:c8\+:40\char`\"{} dmcli e\+RT setv Device.\+Qo\+S.\+Classification.\+1.\+Iface\+In string \char`\"{}brlan0\char`\"{} dmcli e\+RT setv Device.\+Qo\+S.\+Classification.\+1.\+Enable bool true

The Parameter must be set


\begin{DoxyParams}{Parameters}
{\em param} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 SUCCESS -\/1 FAIL 
\end{DoxyReturn}
Delete all classes before

Alloc space for command

Set iptables command in exec

Realloc space

Input exec into firewall and iptables

dealloc space

Integrate qos-\/firewall file into firewall

Definition at line \textbf{ 250} of file \textbf{ classification.\+c}.

\mbox{\label{classification_8c_a733ca25bba1c57325e812bd4c01e0b95}} 
\index{classification.c@{classification.c}!qos\_removeAllClasses@{qos\_removeAllClasses}}
\index{qos\_removeAllClasses@{qos\_removeAllClasses}!classification.c@{classification.c}}
\doxysubsubsection{qos\_removeAllClasses()}
{\footnotesize\ttfamily int qos\+\_\+remove\+All\+Classes (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line \textbf{ 329} of file \textbf{ classification.\+c}.

